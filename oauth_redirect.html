<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>iNat prototypes - OAuth page</title>
    <meta name="author" content="Sean Clifford">
    <link rel="stylesheet" href="css/styles.css?v=1.0">
    <link rel="shortcut icon" href="favicon.ico" type="image/icon">
  </head>
  
  <body>
    <h1>Completing authentication...</h1>
    <div id="result"></div>

    <script type="module">
      import { performTokenRequest, redirectToPreAuthLocation } from "./js/auth.js"

      (async () => {
            
        const urlParams = new URLSearchParams(window.location.search);
        const auth_code = urlParams.get('code');

        await performTokenRequest(auth_code);

        let div = document.getElementById('result');
        div.textContent = "Completed requesting access token!";
        redirectToPreAuthLocation();
      })();
    </script>
  </body>
</html>